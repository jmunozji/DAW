---
title: '4. Servidor FTP'
---
# **Servidor FTP**

# 1. Introducción

Las aplicaciones de transferencia de ficheros fueron una de las primeras herramientas al desarrollarse en la expansión de las redes de internet. La necesidad de poder acceder a diferentes sistemas e intercambiar información originó uno de los sistemas que actualmente se usan.

Actualmente hay diferentes formas de intercambio de información de forma distribuida en formato fichero:
- Sistemas de ficheros en redes
- Software de mensajería
- Software de distribuciones de ficheros P2P (peer-tono-peer)

El FTP (File transfer protocol) o protocolo de transferencia de ficheros es un protocolo que proporciona el servicio de transferencia de ficheros entre sistemas de diferente naturaleza, es decir, se podrán interconectar clientes de Linux hacia un sistema de Microsoft u otros.

## Un poco de historia 
La implementación de la FTP se remonta en el año 1971, cuando se desarrolló un sistema de transferencia de ficheros, definido dentro de la RFC (request for comments) 141, entre equipos del Instituto Tecnológico de Massachusetts (MIT, Massachusetts Institute of Technology). Durante los años posteriores se hicieron diferentes innovaciones al protocolo básico, que se incluyeron en 1973.

El protocolo FTP, tal como se conoce actualmente como estándar, se especifica dentro de la RFC 959 en 1985 y define el funcionamiento del protocolo. Posteriormente, el protocolo FTP se ha ido revisando con algunas nuevas características, pero su base de funcionamiento ha sido mantenida.

# El modelo FTP. ¿Cómo funciona?

El protocolo FTP emplea una arquitectura cliente/servidor, siendo el cliente FTP quien solicita la transferencia de archivos y el servidor FTP quien ofrece los archivos. Pertenece a la familia de protocolos de red TCP y por lo tanto es un protocolo orientado a conexión, esto es, el cliente ftp necesita establecer una conexión con el servidor para empezar la transferencia de ficheros. Si no se establece la conexión ésta no tiene lugar.

Puesto que FTP es un protocolo que no utiliza una autenticación de usuarios y contraseña cifrada, se considera un protocolo inseguro y no se debería utilizar a menos que sea absolutamente necesario. Verás que existen otras alternativas al FTP, como por ejemplo el protocolo FTPS, para mantener comunicaciones cifradas. Aún así, el protocolo FTP está muy extendido en Internet ya que a menudo los usuarios necesitan transferir archivos entre máquinas sin importar la seguridad.

## Canales o puertos de comunicación

El protocolo FTP requiere de dos puertos TCP en el servidor para su funcionamiento, a diferencia de la mayoría de los protocolos utilizados en Internet que solamente requieren un puerto en el servidor. 

Estos dos puertos o canales de comunicación dentro del protocolo FTP son;
- El **canal de control** envía todas las órdenes de comunicación, como pueden ser iniciar la sesión de trabajo y órdenes de ejecución como leer, escribir, listar, borrar, etc.
- El **canal de datos** envía el contenido de aquellos ficheros a trabajar, que puede ser tanto para leer el contenido del fichero como para hacer la escritura del fichero.

Los puertos TCP del servidor en cuestión, suelen ser el 21 para el control de la conexión y otro a determinar según el modo de conexión: podría ser el 20 o incluso uno mayor de 1024. Hay que tener en cuenta que estos puertos pueden ser modificados en la configuración del servidor, así no es obligatorio que los puertos 21 y 20 sean los asignados al servidor FTP, pero sí son los que éste maneja por defecto. El puerto 21 también es conocido como puerto de comandos y el puerto 20 como puerto de datos.

## Procesos DTP y PI en el Servidor y en el Cliente -- BORRARLO ¿?¿

Tanto el cliente como el servidor gestionan dos procesos:
- **Proceso DTP (Data Transfer Protocol, o proceso de transferencia de datos):** es el encargado de establecer la conexión y administrar el canal de datos. Tanto el cliente como el servidor tienen su propio DTP.
- **Proceso PI (Protocol Interpret, intérprete del protocolo):** interpreta el protocolo y permite que el DTP pueda ser controlado mediante órdenes recibidas a través del canal de control.

IMAGEN 

**El proceso PI en el servidor:**

- Escucha las órdenes que provienen del proceso PI del usuario mediante el canal de control por un puerto de datos (puerto 20).
- Establece la conexión del canal de control.
- Recibe las órdenes FTP del proceso PI del usuario, las responde y ejecuta el proceso DTP del servidor.

**El proceso PI en el cliente:**

- Es el responsable de establecer la conexión con el servidor FTP.
- Envía órdenes FTP.
- Recibe las respuestas del servidor PI.
- Controla el DTP del usuario.

> *El modo de funcionamiento es el siguiente; Cuando un cliente conecta al servidor FTP, la PI del usuario inicia la conexión con el servidor con el protocolo  Telnet (RFC 854). El cliente envía órdenes FTP al servidor, el servidor las interpreta, ejecuta el DTP y responde con un formato estándar. Una vez establecida la conexión, el proceso PI del servidor proporciona el puerto por el cual se enviarán los datos al DTP del cliente, por donde escuchará y recibirá los datos del servidor.*

Toda la comunicación que se hace en el canal de control sigue las recomendaciones del protocolo Telnet.  Los canales de control deben permanecer abiertos durante la transferencia de datos. De este modo, un servidor puede detener una transmisión si el canal de control es interrumpido durante la transmisión.




